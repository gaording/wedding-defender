# 阿里云香港服务器部署指南

## ✅ 核心优势

| 优势 | 说明 |
|------|------|
| ✅ **无需备案** | 香港服务器不在境内管辖 |
| ✅ **微信完美** | 移动网络、微信内都流畅 |
| ✅ **国内速度快** | 香港到大陆延迟低 |
| ✅ **熟悉操作** | 阿里云，中文界面 |
| ✅ **支付方便** | 支付宝 |
| ✅ **客服支持** | 7×24中文客服 |

---

## 💰 价格对比

| 配置 | 香港 | 国内（需备案）|
|------|------|-------------|
| 1核1GB | ¥60/月 | ¥60/月 |
| 1核2GB | ¥120/月 | ¥120/月 |
| 2核4GB | ¥240/月 | ¥240/月 |

**结论：** 价格相同，但香港不用备案！

---

## ⚡ 快速部署（20分钟）

### 步骤1：购买服务器（5分钟）

#### 1.1 注册/登录阿里云
```
https://ecs.console.aliyun.com/
如果没有账号，先注册（实名认证）
```

#### 1.2 创建实例
```
1. 控制台 → 云服务器ECS
2. 点击"创建实例"
3. 选择配置：
```

**基础配置：**
```
付费模式：包年包月（或按量付费）
地域：中国香港
可用区：随机选择即可
实例规格：1核 vCPU，1GB内存（或更高）
```

**镜像选择：**
```
类型：公共镜像
操作系统：Ubuntu 20.04 64位
（或Ubuntu 22.04）
```

**存储：**
```
系统盘：40GB ESSD（默认即可）
```

**带宽：**
```
分配公网IP：选中
带宽计费：按使用流量（推荐）
带宽峰值：1Mbps或5Mbps
```

**安全组：**
```
选择：默认安全组（稍后手动配置）
```

**确认订单：**
```
实例名称：wedding-defender
购买时长：1个月（可以先试用）
```

#### 1.3 设置密码
```
创建方式：自定义密码
root密码：设置一个强密码（记住它！）
```

#### 1.4 购买
```
点击"确认订单"
支付：支付宝
```

---

### 步骤2：配置安全组（2分钟）

#### 2.1 找到安全组
```
ECS控制台 → 网络与安全 → 安全组
点击：配置规则
```

#### 2.2 添加入方向规则
```
点击"快速添加"或"手动添加"

需要开放：
1. SSH端口 22
   - 协议类型：自定义TCP
   - 端口范围：22/22
   - 授权对象：0.0.0.0/0

2. HTTP端口 80
   - 协议类型：自定义TCP
   - 端口范围：80/80
   - 授权对象：0.0.0.0/0

3. HTTPS端口 443（可选）
   - 协议类型：自定义TCP
   - 端口范围：443/443
   - 授权对象：0.0.0.0/0
```

---

### 步骤3：连接服务器（2分钟）

#### 3.1 获取IP地址
```
ECS控制台 → 实例
找到：你的香港服务器
复制：公网IP地址（如：47.243.123.45）
```

#### 3.2 使用Workbench（网页版SSH）
```
实例列表 → 点击"远程连接"
选择：Workbench（推荐）
点击：连接

直接在浏览器中操作，无需终端工具
```

#### 3.3 或使用SSH工具
```bash
# Mac/Linux终端
ssh root@47.243.123.45

# Windows使用PuTTY
Host: 47.243.123.45
Port: 22
Username: root
Password: 你设置的密码
```

---

### 步骤4：安装Nginx（3分钟）

#### 4.1 更新系统
```bash
apt update
apt upgrade -y
```

#### 4.2 安装Nginx
```bash
apt install nginx -y
```

#### 4.3 启动Nginx
```bash
systemctl start nginx
systemctl enable nginx
```

#### 4.4 测试访问
```
浏览器访问：http://你的服务器IP
能看到"Welcome to nginx!"说明成功
```

---

### 步骤5：部署网站（5分钟）

#### 方式A：直接创建（最简单）
```bash
# 1. 进入网站目录
cd /var/www/html

# 2. 删除默认页面
rm index.nginx-debian.html

# 3. 创建新的index.html
nano index.html

# 4. 复制h5-version/index.html的内容粘贴进去
# 或者复制下面的命令（一次性创建）
```

#### 方式B：上传文件（FileZilla等）
```
1. 下载FileZilla：https://filezilla-project.org/
2. 配置连接：
   - 主机：你的服务器IP
   - 用户名：root
   - 密码：你设置的密码
   - 端口：22
3. 连接后，进入 /var/www/html/
4. 上传h5-version所有文件
```

#### 方式C：使用Git（推荐）
```bash
# 1. 安装Git
apt install git -y

# 2. 克隆代码（如果你已推送到GitHub/Gitee）
cd /var/www/html
rm -rf *
# 方式1：从GitHub克隆
git clone https://github.com/你的用户名/wedding-defender.git .
# 方式2：从Gitee克隆
git clone https://gitee.com/你的用户名/wedding-defender.git .
```

#### 创建完整的HTML文件
```bash
cat > /var/www/html/index.html << 'EOF'
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>催婚防御助手</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- 这里应该是你完整的HTML内容 -->
  <!-- 请手动复制h5-version/index.html的内容 -->
  <h1>催婚防御助手</h1>
  <p>部署成功！</p>
  <script src="js/data.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
EOF

# 注意：上面只是示例，需要手动编辑完整内容
```

#### 需要创建的文件结构
```bash
cd /var/www/html

# 创建目录
mkdir -p css js images

# 创建css文件（复制h5-version/css/style.css的内容）
nano css/style.css
# 粘贴内容后Ctrl+O保存，Ctrl+X退出

# 创建js文件
nano js/data.js
nano js/utils.js
nano js/app.js
# 分别复制对应内容

# 创建images目录（暂时为空）
mkdir images
```

**重要提示：** 阿里云Workbench支持直接粘贴，建议：

1. 在本地打开 `h5-version/index.html`
2. 全选复制（Ctrl+A, Ctrl+C）
3. 在Workbench中：
   ```bash
   cd /var/www/html
   nano index.html
   # 右键粘贴内容
   # Ctrl+O 保存
   # Ctrl+X 退出
   ```

---

### 步骤6：测试访问（2分钟）

#### 6.1 浏览器测试
```
http://你的服务器IP

应该能看到催婚防御助手页面
```

#### 6.2 手机浏览器测试
```
手机Safari/Chrome访问
应该正常显示
```

#### 6.3 微信测试
```
1. 复制链接
2. 微信里粘贴发送
3. 点击打开
4. ✅ 成功访问！
```

#### 6.4 4G/5G测试
```
关闭WiFi，用移动网络访问
确保4G/5G也能正常打开
```

---

## 🌐 绑定域名（可选，10分钟）

### 步骤1：购买域名
```
推荐：阿里云万网
https://wanwang.aliyun.com/

搜索：chunyuan-helper.com
购买：.com约50-70元/年
```

### 步骤2：域名解析
```
域名控制台 → 解析设置
添加记录：

类型：A
主机记录：@
记录值：你的服务器IP
TTL：600

同时添加www：
类型：A
主机记录：www
记录值：你的服务器IP
TTL：600
```

### 步骤3：Nginx配置域名
```bash
# 编辑Nginx配置
nano /etc/nginx/sites-available/default

# 找到server_name，改为：
server_name 你的域名.com www.你的域名.com;

# 保存后重启Nginx
systemctl restart nginx
```

### 步骤4：访问测试
```
http://你的域名.com
https://你的域名.com（如果配置了HTTPS）
```

---

## 🔒 配置HTTPS（可选，5分钟）

### 使用Let's Encrypt免费证书

#### 安装Certbot
```bash
apt install certbot python3-certbot-nginx -y
```

#### 申请证书
```bash
certbot --nginx -d 你的域名.com -d www.你的域名.com

# 按提示操作
# 输入邮箱
# 同意协议
```

#### 自动续期
```bash
# 测试自动续期
certbot renew --dry-run

# Certbot会自动添加定时任务
```

#### 完成
```
https://你的域名.com
浏览器地址栏显示🔒安全锁
```

---

## 💡 进阶优化

### 开启Gzip压缩
```bash
nano /etc/nginx/nginx.conf

# 在http块中添加或确认：
gzip on;
gzip_vary on;
gzip_proxied any;
gzip_comp_level 6;
gzip_types text/plain text/css text/xml text/javascript application/json application/javascript application/xml+rss application/rss+xml font/truetype font/opentype application/vnd.ms-fontobject image/svg+xml;
```

### 配置缓存
```bash
nano /etc/nginx/sites-available/default

# 在server块添加：
location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}
```

### 重启Nginx
```bash
systemctl restart nginx
```

---

## 🛠️ 常用命令

### 查看Nginx状态
```bash
systemctl status nginx
```

### 重启Nginx
```bash
systemctl restart nginx
```

### 查看网站错误日志
```bash
tail -f /var/log/nginx/error.log
```

### 查看访问日志
```bash
tail -f /var/log/nginx/access.log
```

### 更新网站文件
```bash
cd /var/www/html
nano index.html
# 或重新上传
```

---

## 💰 费用说明

### ECS实例费用（香港）
| 配置 | 包年包月 | 按量付费 |
|------|---------|---------|
| 1核1GB | ¥60/月 | ≈¥0.08/小时 |
| 1核2GB | ¥120/月 | ≈¥0.16/小时 |
| 2核4GB | ¥240/月 | ≈¥0.32/小时 |

### 流量费用
```
按量付费模式：
- 流量：¥0.80/GB
- 1Mbps带宽：每月约≈300GB

建议：小网站用包年包月更划算
```

### 总费用估算
```
春节用1个月（1核1GB）：
¥60（ECS）+ ¥0（其他）= ¥60

如果按量付费（假设每天运行10小时）：
¥0.08 × 10小时 × 30天 = ¥24
```

---

## ✅ 部署检查清单

- [ ] 购买阿里云香港ECS
- [ ] 配置安全组（22, 80, 443端口）
- [ ] 连接服务器
- [ ] 安装Nginx
- [ ] 部署h5-version文件
- [ ] 浏览器测试访问
- [ ] 手机浏览器测试
- [ ] 微信内测试
- [ ] 4G/5G网络测试
- [ ] （可选）绑定域名
- [ ] （可选）配置HTTPS
- [ ] （可选）生成二维码分享

---

## 🎯 完成时间线

| 步骤 | 耗时 |
|------|------|
| 购买服务器 | 5分钟 |
| 配置安全组 | 2分钟 |
| 连接服务器 | 2分钟 |
| 安装Nginx | 3分钟 |
| 部署文件 | 5分钟 |
| 测试访问 | 3分钟 |
| **总计** | **20分钟** |

---

## 🆘 常见问题

### Q: 香港服务器真的不需要备案吗？
A: 是的！香港不在境内管辖范围，完全不需要ICP备案。

### Q: 微信能正常访问吗？
A: 完全可以！香港服务器微信访问无障碍。

### Q: 国内访问速度快吗？
A: 香港->大陆延迟低（通常<50ms），速度很快。

### Q: 按量付费和包月怎么选？
A:
- 按量：适合临时使用，用完可释放
- 包月：适合持续使用，价格更划算

### Q: 忘记root密码怎么办？
A: ECS控制台 → 实例 → 更多 → 重置实例密码

### Q: 怎么停止计费？
A: ECS控制台 → 实例 → 停止（按量付费）
或 释放（删除实例，彻底停止计费）

### Q: 数据会丢吗？
A: 释放实例前务必备份数据！释放后数据无法恢复。

---

## 📞 获取帮助

### 阿里云文档
```
ECS文档：https://help.aliyun.com/product/25365.html
Nginx文档：https://help.aliyun.com/document_detail/140290.html
```

### 阿里云客服
```
工单系统：7×24小时
电话：95187
```

---

## 🎉 完成部署！

你的催婚防御助手已上线：
```
http://你的服务器IP
或
http://你的域名.com（如果配置）
```

### 下一步
1. 生成二维码
2. 分享到微信群
3. 春节救急！

**春节快乐，优雅应对催婚！** 🍀
