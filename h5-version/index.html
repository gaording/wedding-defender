<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="催婚防御助手 - 帮助大龄单身青年优雅应对春节催婚问题">
  <title>催婚防御助手</title>

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#667eea">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- 图标 -->
  <link rel="icon" type="image/png" sizes="192x192" href="images/icon-192.png">
  <link rel="apple-touch-icon" href="images/icon-192.png">

  <!-- 样式 -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- 底部导航 -->
  <nav class="bottom-nav">
    <a href="#home" class="nav-item active" data-page="home">
      <span class="nav-icon">🏠</span>
      <span class="nav-label">首页</span>
    </a>
    <a href="#arsenal" class="nav-item" data-page="arsenal">
      <span class="nav-icon">🛡️</span>
      <span class="nav-label">武器库</span>
    </a>
    <a href="#community" class="nav-item" data-page="community">
      <span class="nav-icon">🌳</span>
      <span class="nav-label">树洞</span>
    </a>
    <a href="#profile" class="nav-item" data-page="profile">
      <span class="nav-icon">👤</span>
      <span class="nav-label">我的</span>
    </a>
  </nav>

  <!-- 主内容区域 -->
  <main class="main-content">
    <!-- 首页 -->
    <section id="page-home" class="page active">
      <div class="container">
        <!-- 头部问候 -->
        <div class="header-card">
          <h1 class="greeting">你好，单身战士</h1>
          <p class="greeting-subtitle">今天也要优雅地应对催婚</p>

          <!-- 每日buff -->
          <div class="daily-buff" id="dailyBuff">
            <span class="buff-icon">🍀</span>
            <div class="buff-content">
              <span class="buff-title">今日幸运buff</span>
              <span class="buff-desc" id="buffDesc">点击查看今日运势</span>
            </div>
          </div>
        </div>

        <!-- 数据统计 -->
        <div class="stats-card">
          <div class="stat-item">
            <span class="stat-value" id="defenseCount">0</span>
            <span class="stat-label">成功应对</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-value" id="diaryCount">0</span>
            <span class="stat-label">日记篇数</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-value" id="postCount">0</span>
            <span class="stat-label">社区发言</span>
          </div>
        </div>

        <!-- 每日一句 -->
        <div class="quote-card">
          <div class="quote-header">
            <span class="quote-icon">💭</span>
            <span class="quote-title">今日安慰</span>
          </div>
          <p class="quote-text" id="dailyQuote">优秀的你值得等待，优秀的婚姻也值得等待。</p>
          <p class="quote-author" id="quoteAuthor"></p>
        </div>

        <!-- 快速入口 -->
        <div class="quick-actions">
          <div class="action-card highlight-card" onclick="window.location.href='realtime.html'">
            <span class="action-icon">🎤</span>
            <span class="action-title">实时助手</span>
            <span class="action-desc">聚会时的对线神器</span>
          </div>
          <div class="action-card" onclick="navigateTo('arsenal')">
            <span class="action-icon">🛡️</span>
            <span class="action-title">生成话术</span>
            <span class="action-desc">快速获取应对策略</span>
          </div>
          <div class="action-card" onclick="showModal('diary')">
            <span class="action-icon">📝</span>
            <span class="action-title">写日记</span>
            <span class="action-desc">记录催婚场景</span>
          </div>
          <div class="action-card" onclick="navigateTo('community')">
            <span class="action-icon">🌳</span>
            <span class="action-title">树洞</span>
            <span class="action-desc">匿名吐槽分享</span>
          </div>
        </div>

        <!-- 称号展示 -->
        <div class="titles-card" id="titlesCard" style="display: none;">
          <h3 class="titles-title">🏆 我的称号</h3>
          <div class="titles-list" id="titlesList"></div>
        </div>
      </div>
    </section>

    <!-- 武器库页面 -->
    <section id="page-arsenal" class="page">
      <div class="container">
        <h2 class="page-title">武器库</h2>

        <!-- 话术生成器 -->
        <div class="card generator-card">
          <h3 class="card-title">话术生成器</h3>

          <div class="selector-group">
            <label class="selector-label">提问对象</label>
            <div class="tags-list" id="roleTags">
              <button class="tag-btn" data-value="parents">👨‍👩‍👧 父母</button>
              <button class="tag-btn" data-value="relatives">👵 亲戚</button>
              <button class="tag-btn" data-value="peers">👥 同辈</button>
              <button class="tag-btn" data-value="elders">👴 长辈</button>
            </div>
          </div>

          <div class="selector-group">
            <label class="selector-label">问题类型</label>
            <div class="tags-list" id="questionTags">
              <button class="tag-btn" data-value="when_married">💍 什么时候结婚</button>
              <button class="tag-btn" data-value="have_partner">💑 有对象了吗</button>
              <button class="tag-btn" data-value="when_back">🏠 什么时候带回来</button>
              <button class="tag-btn" data-value="compare_others">👶 别人家孩子...</button>
            </div>
          </div>

          <div class="selector-group">
            <label class="selector-label">回应风格</label>
            <div class="tags-list" id="styleTags">
              <button class="tag-btn" data-value="gentle">🌸 温和委婉</button>
              <button class="tag-btn" data-value="humor">😄 幽默自嘲</button>
              <button class="tag-btn" data-value="rational">🧠 理性分析</button>
              <button class="tag-btn" data-value="counter">↩️ 反客为主</button>
              <button class="tag-btn" data-value="philosophy">📖 哲学金句</button>
            </div>
          </div>

          <button class="btn-primary" id="generateBtn" disabled>生成话术</button>

          <!-- 生成结果 -->
          <div class="result-card" id="resultCard" style="display: none;">
            <div class="result-header">
              <span class="result-title">应对话术</span>
              <div class="result-actions">
                <button class="action-btn" onclick="copyScript()">复制</button>
                <button class="action-btn" onclick="generateScript()">换一条</button>
              </div>
            </div>
            <p class="result-script" id="resultScript"></p>
            <p class="result-usage" id="resultUsage"></p>
            <button class="btn-record" onclick="recordDefense()">✅ 记录一次成功应对</button>
          </div>

          <!-- 收藏的话术 -->
          <div class="favorite-section" id="favoriteSection" style="display: none;">
            <h4 class="favorite-title">⭐ 我的收藏</h4>
            <div class="favorite-list" id="favoriteList"></div>
          </div>
        </div>

        <!-- 数据反击 -->
        <div class="card">
          <h3 class="card-title">数据反击卡</h3>
          <div class="data-cards" id="dataCards"></div>
        </div>
      </div>
    </section>

    <!-- 社区页面 -->
    <section id="page-community" class="page">
      <div class="container">
        <h2 class="page-title">树洞社区</h2>

        <!-- 发帖按钮 -->
        <button class="fab" onclick="showModal('post')">+</button>

        <!-- 帖子列表 -->
        <div class="posts-list" id="postsList">
          <!-- 动态生成 -->
        </div>
      </div>
    </section>

    <!-- 我的页面 -->
    <section id="page-profile" class="page">
      <div class="container">
        <h2 class="page-title">我的</h2>

        <!-- 用户信息 -->
        <div class="user-card">
          <div class="user-avatar">👤</div>
          <h3 class="user-name">单身战士</h3>
          <span class="user-level">Lv.<span id="userLevel">1</span></span>

          <div class="titles-section" id="profileTitles" style="display: none;">
            <h4 class="section-title">🏆 已获称号</h4>
            <div class="titles-list" id="profileTitlesList"></div>
          </div>
        </div>

        <!-- 菜单 -->
        <div class="menu-list">
          <div class="menu-item" onclick="showModal('diary')">
            <span class="menu-icon">📝</span>
            <span class="menu-title">催婚日记</span>
            <span class="menu-arrow">›</span>
          </div>
          <div class="menu-item" onclick="showModal('guide')">
            <span class="menu-icon">🌉</span>
            <span class="menu-title">沟通指南</span>
            <span class="menu-arrow">›</span>
          </div>
          <div class="menu-item" onclick="showModal('game')">
            <span class="menu-icon">🎮</span>
            <span class="menu-title">剧本杀</span>
            <span class="menu-arrow">›</span>
          </div>
          <div class="menu-item" onclick="shareApp()">
            <span class="menu-icon">📤</span>
            <span class="menu-title">分享给朋友</span>
            <span class="menu-arrow">›</span>
          </div>
        </div>

        <div class="footer">
          <p class="footer-text">你不是一个人在战斗</p>
          <p class="footer-subtitle">一起优雅应对催婚</p>
        </div>
      </div>
    </section>
  </main>

  <!-- 弹窗组件 -->
  <div class="modal" id="modal" style="display: none;">
    <div class="modal-overlay" onclick="closeModal()"></div>
    <div class="modal-content" id="modalContent">
      <!-- 动态内容 -->
    </div>
  </div>

  <!-- Toast提示 -->
  <div class="toast" id="toast"></div>

  <!-- JavaScript -->
  <script src="js/data.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/app.js"></script>

  <!-- 微信分享配置（如果有JSSDK） -->
  <script>
    // 简单的微信分享引导
    function shareApp() {
      const modal = document.getElementById('modal');
      const content = document.getElementById('modalContent');

      // 判断是否在微信中
      const isWechat = /MicroMessenger/i.test(navigator.userAgent);

      if (isWechat) {
        content.innerHTML = `
          <div class="share-guide">
            <h3>分享给朋友</h3>
            <p>点击右上角 <strong>···</strong></p>
            <p>选择 <strong>发送给朋友</strong> 或 <strong>分享到朋友圈</strong></p>
            <p class="share-tip">让更多战友加入吧！🍀</p>
            <button class="btn-primary" onclick="closeModal()">知道了</button>
          </div>
        `;
      } else {
        content.innerHTML = `
          <div class="share-guide">
            <h3>分享链接</h3>
            <p>复制下方链接分享给朋友：</p>
            <input class="share-url" value="${window.location.href}" readonly onclick="this.select()">
            <button class="btn-primary" onclick="copyUrl()">复制链接</button>
            <button class="btn-secondary" onclick="closeModal()">关闭</button>
          </div>
        `;
      }

      modal.style.display = 'flex';
    }

    function copyUrl() {
      const url = window.location.href;
      navigator.clipboard.writeText(url).then(() => {
        showToast('链接已复制');
      });
    }
  </script>
</body>
</html>
