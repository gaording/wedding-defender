<!--pages/arsenal/arsenal.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨Tabåˆ‡æ¢ -->
  <view class="tabs">
    <view class="tab-item {{currentTab === 'script' ? 'active' : ''}}" bindtap="switchTab" data-tab="script">
      è¯æœ¯ç”Ÿæˆå™¨
    </view>
    <view class="tab-item {{currentTab === 'emoji' ? 'active' : ''}}" bindtap="switchTab" data-tab="emoji">
      è¡¨æƒ…åŒ…
    </view>
    <view class="tab-item {{currentTab === 'data' ? 'active' : ''}}" bindtap="switchTab" data-tab="data">
      æ•°æ®åå‡»
    </view>
  </view>

  <!-- è¯æœ¯ç”Ÿæˆå™¨ -->
  <view class="tab-content" wx:if="{{currentTab === 'script'}}">
    <view class="card selector-card">
      <view class="selector-section">
        <text class="selector-label">æé—®å¯¹è±¡</text>
        <view class="tags-container">
          <view class="tag {{selectedRole === item.value ? 'active' : ''}}"
                wx:for="{{roleOptions}}"
                wx:key="value"
                bindtap="selectRole"
                data-value="{{item.value}}">
            {{item.label}}
          </view>
        </view>
      </view>

      <view class="divider"></view>

      <view class="selector-section">
        <text class="selector-label">é—®é¢˜ç±»å‹</text>
        <view class="tags-container">
          <view class="tag {{selectedQuestionType === item.value ? 'active' : ''}}"
                wx:for="{{questionTypeOptions}}"
                wx:key="value"
                bindtap="selectQuestionType"
                data-value="{{item.value}}">
            {{item.label}}
          </view>
        </view>
      </view>

      <view class="divider"></view>

      <view class="selector-section">
        <text class="selector-label">å›åº”é£æ ¼</text>
        <view class="tags-container">
          <view class="tag {{selectedStyle === item.value ? 'active' : ''}}"
                wx:for="{{styleOptions}}"
                wx:key="value"
                bindtap="selectStyle"
                data-value="{{item.value}}">
            {{item.label}}
          </view>
        </view>
      </view>
    </view>

    <button class="btn-generate" bindtap="generateScript" disabled="{{!canGenerate}}">
      {{canGenerate ? 'ç”Ÿæˆè¯æœ¯' : 'è¯·é€‰æ‹©å®Œæ•´é€‰é¡¹'}}
    </button>

    <!-- ç”Ÿæˆç»“æœ -->
    <view class="card result-card" wx:if="{{generatedScript}}">
      <view class="result-header">
        <text class="result-title">åº”å¯¹è¯æœ¯</text>
        <view class="result-actions">
          <text class="action-btn" bindtap="copyScript">å¤åˆ¶</text>
          <text class="action-btn" bindtap="regenerateScript">æ¢ä¸€æ¡</text>
        </view>
      </view>
      <view class="result-content">
        <text class="script-text">{{generatedScript.script}}</text>
        <text class="script-usage" wx:if="{{generatedScript.usage}}">
          ğŸ’¡ {{generatedScript.usage}}
        </text>
      </view>
      <button class="btn-record" bindtap="recordUse">
        è®°å½•ä¸€æ¬¡æˆåŠŸåº”å¯¹
      </button>
    </view>

    <!-- æ”¶è—çš„è¯æœ¯ -->
    <view class="card favorite-card" wx:if="{{favoriteScripts.length > 0}}">
      <view class="favorite-header">
        <text class="favorite-title">â­ æˆ‘çš„æ”¶è—</text>
      </view>
      <view class="favorite-list">
        <view class="favorite-item" wx:for="{{favoriteScripts}}" wx:key="id" bindtap="useFavorite" data-item="{{item}}">
          <text class="favorite-text">{{item.script}}</text>
          <text class="favorite-time">{{item.time}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- è¡¨æƒ…åŒ… -->
  <view class="tab-content" wx:if="{{currentTab === 'emoji'}}">
    <view class="emoji-grid">
      <view class="emoji-item" wx:for="{{emojiList}}" wx:key="index" bindtap="previewEmoji" data-url="{{item}}">
        <image class="emoji-image" src="{{item}}" mode="aspectFit"></image>
        <text class="emoji-action">é•¿æŒ‰ä¿å­˜</text>
      </view>
    </view>
  </view>

  <!-- æ•°æ®åå‡» -->
  <view class="tab-content" wx:if="{{currentTab === 'data'}}">
    <view class="data-list">
      <view class="data-card" wx:for="{{dataCards}}" wx:key="id" bindtap="viewDataCard" data-item="{{item}}">
        <text class="data-title">{{item.title}}</text>
        <text class="data-desc">{{item.description}}</text>
        <view class="data-tags">
          <text class="data-tag tag-primary">{{item.category}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
